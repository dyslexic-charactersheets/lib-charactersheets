@use "common";

/**
 * Copyright 2025 Marcus Downing
 * Licensed under the Artistic License 2.0
 */

@use "sass:math";

$rb: 0.8rem;
$halfrb: math.div($rb, 2);
$rbsp: 0.1rem;
  
.ruby {
  position: relative;
  display: flex;
	flex-direction: row;
  align-items: flex-end;

  .ruby__sub {
    position: absolute;
    left: -$halfrb;
    right: -$halfrb;
    bottom: -($rb + 2 * common.$pt);
    height: $rb;
    display: flex;
    flex-direction: row;
    justify-content: center;
  }

  &.ruby--arms {
    .ruby__sub {
      &:before {
        content: "";
        display: block;
        border-bottom: common.$pt solid #a0a0a0;
        border-left: common.$pt solid #a0a0a0;
        border-bottom-left-radius: $halfrb;
        padding-bottom: $halfrb;
        flex: 1 1 $rb;
        margin-bottom: $rb;
      }
    
      &:after {
        content: "";
        display: block;
        border-bottom: common.$pt solid #a0a0a0;
        border-right: common.$pt solid #a0a0a0;
        border-bottom-right-radius: $halfrb;
        padding-bottom: $halfrb;
        flex: 1 1 $rb;
        margin-bottom: $rb;
      }
    }
  }

  label.ruby__text {
    line-height: $rb;
    white-space: nowrap;
    padding: 0 common.$pt;

    .rb_1 & {
      bottom: -($rbsp + $rb);
    }
    .rb_2 & {
      bottom: -($rbsp + $rb * 2);
    }
    .rb_3 & {
      bottom: -($rbsp + $rb * 3);
    }
  }
}

.field {
  &.rb_1 {
    padding-bottom: $rbsp + $rb;
  }
  &.rb_2 {
    padding-bottom: $rbsp + $rb * 2;
  }
  &.rb_3 {
    padding-bottom: $rbsp + $rb * 3;
  }
}

.field__ruby-text {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  
  // .rb_1 & {
  //   bottom: -($rbsp + $rb);
  // }
  // .rb_2 & {
  //   bottom: -($rbsp + $rb * 2);
  // }
  // .rb_3 & {
  //   bottom: -($rbsp + $rb * 3);
  // }
}

.row {
  &.rb_1 {
    padding-bottom: $rbsp + $rb;
    .rb_1, .rb_2, .rb_3 { padding-bottom: 0; }
    .field__ruby-text { bottom: -($rbsp + $rb); }
  }
  &.rb_2 {
    padding-bottom: $rbsp + $rb * 2;
    .rb_1, .rb_2, .rb_3 { padding-bottom: 0; }
    .field__ruby-text { bottom: -($rbsp + $rb * 2); }
  }
  &.rb_3 {
    padding-bottom: $rbsp + $rb * 3;
    .rb_1, .rb_2, .rb_3 { padding-bottom: 0; }
    .field__ruby-text { bottom: -($rbsp + $rb * 3); }
  }
}
